import{a as Z}from"./chunk-I2NOJ6RZ.js";import"./chunk-V4PXP256.js";import{a as Q,b as F,e as T}from"./chunk-QVUSE63M.js";import{B as wt,D as bt,S as Et,U as R,ba as O,ca as Dt,da as Mt,ea as It,fa as Pt,g as gt,ga as Ft,h as ft,ha as Tt,ia as Rt,ja as Ot,ka as At,la as Ht,m as ht,ma as Bt,n as vt,na as Vt,o as _,oa as Nt,p as _t,qa as kt,r as St,s as Ct,t as Lt,v as yt,w as xt}from"./chunk-JBASF3LD.js";import"./chunk-RGNDWIHZ.js";import{b as dt,d as ct,j as I,l as P,p as ut}from"./chunk-TN7LRJOG.js";import{l as mt,o as M,q as st,t as pt}from"./chunk-MKB6ZC6F.js";import{$b as $,Aa as it,Ab as p,Ba as nt,Jb as a,Kb as o,Lb as u,Mb as f,N as W,Nb as h,Pb as at,S as X,Vb as v,Xb as y,ac as G,ba as z,bb as E,bc as q,eb as l,fb as c,fc as r,g as S,gc as D,ha as Y,hc as s,ia as tt,ic as rt,m as K,ma as U,ra as b,rc as C,sa as et,sc as lt,tc as x,vb as d,x as w,zb as ot}from"./chunk-L2AW7WK7.js";var L=class i{constructor(t,e){this.http=t;this.utilService=e}getLogList(t){return t.get("from")&&t.get("to")&&(t=t.set("from",this.utilService.removeZ(t.get("from")??"")),t=t.set("to",this.utilService.removeZ(t.get("to")??""))),w(this.http.get(F.LOG,{params:t}))}getLogById(t){return w(this.http.get(`${F.LOG}/${t}`))}getConstants(){return w(this.http.get(`${F.LOG_CONSTANT}`))}static \u0275fac=function(e){return new(e||i)(U(ct),U(T))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var A=class i{constructor(t,e,n){this.logService=t;this._activatedRoute=e;this._router=n;this._activatedRoute.paramMap.subscribe(m=>S(this,null,function*(){this.data=yield this.logService.getLogById(m.get("id")??"")})),this._activatedRoute.queryParams.subscribe(m=>{this.urlParams=m})}data;urlParams=null;replaceString(t){return t=t.replaceAll(/\n/g,"<br />"),t}backToList(){this._router.navigate(["/log-report"],{queryParams:this.urlParams})}static \u0275fac=function(e){return new(e||i)(c(L),c(I),c(P))};static \u0275cmp=b({type:i,selectors:[["app-log-details"]],decls:67,vars:14,consts:[[1,"w-full","p-8"],[1,"md:flex","justify-between","w-full","items-center","mb-8"],[1,"text-primary","text-xl","font-bold","md:m-0"],["mat-button","",1,"rounded",3,"click"],[1,"mr-1"],[1,"font-bold","text-lg","px-6","py-3","bg-primary","text-white","rounded","rounded-b-none","m-0"],[1,"w-full","rounded","bg-white","rounded-t-none","p-6","md:flex"],[1,"md:w-6/12","md:pr-2"],[1,"font-bold","text-base","px-4","py-3","border","rounded","rounded-b-none","border-b-0","m-0"],[1,"w-full","border","rounded","p-4","rounded-t-none"],[1,"md:flex"],[1,"md:w-5/12","font-medium"],[1,"md:w-7/12"],[1,"md:flex","mt-3"],[1,"md:w-6/12","md:pl-2"],[1,"w-full","border","rounded","p-4","rounded-t-none","md:h-[81%]"],[1,"md:flex","mt-6"],[1,"md:w-6/12","md:mr-2","rounded","bg-white"],[1,"font-bold","text-lg","px-6","py-3","bg-primary","text-white","rounded","rounded-b-none"],[1,"w-full","p-6","details-container",3,"innerHTML"],[1,"md:w-6/12","md:ml-2","rounded","bg-white"],[1,"w-full","p-6","details-container"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Log Report Details"),o(),a(4,"button",3),v("click",function(){return n.backToList()}),a(5,"mat-icon",4),r(6,"arrow_back"),o(),r(7," Back to Log Report "),o()(),a(8,"h4",5),r(9,"Log Report Details"),o(),a(10,"div",6)(11,"div",7)(12,"h4",8),r(13,"Log Information"),o(),a(14,"div",9)(15,"div",10)(16,"p",11),r(17,"Type"),o(),a(18,"p",12),r(19),o()(),a(20,"div",13)(21,"p",11),r(22,"Action"),o(),a(23,"p",12),r(24),o()(),a(25,"div",13)(26,"p",11),r(27,"Operation"),o(),a(28,"p",12),r(29),o()(),a(30,"div",13)(31,"p",11),r(32,"Date & Time"),o(),a(33,"p",12),r(34),C(35,"date"),o()()()(),a(36,"div",14)(37,"h4",8),r(38,"User Information"),o(),a(39,"div",15)(40,"div",10)(41,"p",11),r(42,"Name"),o(),a(43,"p",12),r(44),o()(),a(45,"div",13)(46,"p",11),r(47,"Email Address"),o(),a(48,"p",12),r(49),o()(),a(50,"div",13)(51,"p",11),r(52,"Role"),o(),a(53,"p",12),r(54),o()()()()(),a(55,"div",16)(56,"div",17)(57,"h4",18),r(58,"Description"),o(),u(59,"div",19),o(),a(60,"div",20)(61,"h4",18),r(62,"Data"),o(),a(63,"div",21)(64,"pre"),r(65),C(66,"json"),o()()()()()),e&2){let m,g,B,V,N,k,j;l(19),s(" ",(m=n.data==null?null:n.data.type)!==null&&m!==void 0?m:"-"," "),l(5),s(" ",(g=n.data==null?null:n.data.action)!==null&&g!==void 0?g:"-"," "),l(5),s(" ",(B=n.data==null?null:n.data.operation)!==null&&B!==void 0?B:"-"," "),l(5),s(" ",x(35,9,n.data==null?null:n.data.createdAt,"HH:mm:ss | dd MMM yyyy")," "),l(10),s(" ",(V=n.data==null?null:n.data.name)!==null&&V!==void 0?V:"-"," "),l(5),s(" ",(N=n.data==null?null:n.data.email)!==null&&N!==void 0?N:"-"," "),l(5),s(" ",(k=n.data==null?null:n.data.role)!==null&&k!==void 0?k:"-"," "),l(5),p("innerHTML",n.replaceString((j=n.data==null?null:n.data.description)!==null&&j!==void 0?j:""),E),l(6),s("                    ",lt(66,12,n.data==null?null:n.data.data),`
                `)}},dependencies:[ft,bt,st,M],styles:["td[_ngcontent-%COMP%]{border:1px solid rgba(var(--fuse-border-rgb),var(--tw-border-opacity));padding:5px 10px}.details-container[_ngcontent-%COMP%]{overflow:auto;max-height:calc(45vh - 60px)}"]})};function Qt(i,t){if(i&1&&(a(0,"mat-option",30),r(1),o()),i&2){let e=t.$implicit;p("value",e),l(),D(e)}}function Zt(i,t){if(i&1&&(a(0,"mat-option",30),r(1),o()),i&2){let e=t.$implicit;p("value",e),l(),D(e)}}function Jt(i,t){if(i&1&&(a(0,"mat-option",30),r(1),o()),i&2){let e=t.$implicit;p("value",e),l(),D(e)}}function Kt(i,t){i&1&&(a(0,"th",31),r(1," No. "),o())}function Wt(i,t){if(i&1&&(a(0,"td",32),r(1),o()),i&2){let e=t.index,n=y();l(),s(" ",n.pagination.pageIndex*n.pagination.pageSize+(e+1)," ")}}function Xt(i,t){i&1&&(a(0,"th",33),r(1," User Name "),o())}function Yt(i,t){if(i&1&&(a(0,"td",34),r(1),u(2,"br"),r(3),o()),i&2){let e=t.$implicit;l(),rt(" ",e.name," ",e.role?"("+e.role+")":""," "),l(2),s(" ",e.email," ")}}function te(i,t){i&1&&(a(0,"th",33),r(1," Type "),o())}function ee(i,t){if(i&1&&(a(0,"td",34),r(1),o()),i&2){let e=t.$implicit;l(),s(" ",e.type," ")}}function ie(i,t){i&1&&(a(0,"th",33),r(1," Action "),o())}function ne(i,t){if(i&1&&(a(0,"td",34),r(1),o()),i&2){let e=t.$implicit;l(),s(" ",e.action," ")}}function oe(i,t){i&1&&(a(0,"th",33),r(1," Operation "),o())}function ae(i,t){if(i&1&&(a(0,"td",34),r(1),o()),i&2){let e=t.$implicit;l(),s(" ",e.operation," ")}}function re(i,t){i&1&&(a(0,"th",33),r(1," Description "),o())}function le(i,t){if(i&1&&(a(0,"td",35),u(1,"div",36),o()),i&2){let e=t.$implicit,n=y();l(),p("innerHTML",n.replaceString(e.description),E)}}function me(i,t){i&1&&(a(0,"th",33),r(1," Date & Time "),o())}function se(i,t){if(i&1&&(a(0,"td",34),r(1),C(2,"date"),u(3,"br",37),r(4),C(5,"date"),o()),i&2){let e=t.$implicit;l(),s(" ",x(2,2,e==null?null:e.createdAt,"HH:mm:ss"),""),l(3),s(" ",x(5,5,e==null?null:e.createdAt,"dd MMM yyyy")," ")}}function pe(i,t){i&1&&u(0,"tr",38)}function de(i,t){if(i&1&&(a(0,"tr",39)(1,"td",40),r(2," No data found "),o()()),i&2){let e=y();l(),ot("colspan",e.displayedColumns.length)}}function ce(i,t){if(i&1){let e=at();a(0,"tr",41),v("click",function(){let m=it(e).$implicit,g=y();return nt(g.goToDetails(m))}),o()}}var H=class i{constructor(t,e,n,m,g){this._fb=t;this._logService=e;this._utilService=n;this._activatedRoute=m;this._router=g}sort;paginator;accessControls=Q;constantValues=null;displayedColumns=["no","name","type","action","operation","description","createdAt"];dataSource=new Nt;pagination={pageSizeOptions:[10,25,50,100],pageSize:10,pageIndex:0};searchForm;onDestroy=new K;urlParams=null;ngOnInit(){this.searchForm=this._fb.group({searchString:new _(null),action:new _(null),type:new _(null),operation:new _(null),sortBy:new _(""),sortOrder:new _("")}),this._activatedRoute.queryParams.pipe(z(this.onDestroy)).subscribe(t=>{try{let e=this._utilService.decode(t.q);this.urlParams=e;let n={};e?.page&&!this.pagination.pageIndex&&(this.pagination.pageIndex=parseInt(e?.page)),e?.size&&(this.pagination.pageSize=e?.size),e?.searchString&&!this.searchForm.value.searchString&&(n.searchString=e?.searchString),e?.action&&!this.searchForm.value.action&&(n.action=e?.action),e?.type&&!this.searchForm.value.type&&(n.type=e?.type),e?.operation&&!this.searchForm.value.operation&&(n.operation=e?.operation),e?.sortBy&&!this.searchForm.value.sortBy&&(n.sortBy=e?.sortBy),e?.sortOrder&&!this.searchForm.value.sortOrder&&(n.sortOrder=e?.sortOrder),this.searchForm.patchValue(n)}catch(e){this._utilService.showErrorSnack(e)}}),this.searchForm.get("searchString")?.valueChanges.pipe(z(this.onDestroy),W(500),X()).subscribe(t=>S(this,null,function*(){this.resetPagination(),yield this.getLogList()})),this.getLogList(),this.getConstantValues()}resetPagination(){this.pagination.pageIndex=0}getConstantValues(){return S(this,null,function*(){try{this.constantValues=yield this._logService.getConstants()}catch(t){this._utilService.showErrorSnack(t)}})}updateRoute(){let t={page:this.pagination.pageIndex,size:this.pagination.pageSize,searchString:this.searchForm.value.searchString??"",action:this.searchForm.value.action??"",type:this.searchForm.value.type??"",operation:this.searchForm.value.operation??"",sortBy:this.searchForm.value.sortBy??"",sortOrder:this.searchForm.value.sortOrder??""};this._router.navigate([],{replaceUrl:!0,relativeTo:this._activatedRoute,queryParams:{q:this._utilService.encode(t)},queryParamsHandling:"merge"})}ngAfterViewInit(){this.urlParams?.sortBy&&this.urlParams?.sortOrder&&this.sort.sort({id:this.urlParams.sortBy,start:this.urlParams.sortOrder.toLowerCase()}),this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="Records Per Page"}ngOnDestroy(){this.onDestroy.next(),this.onDestroy.complete()}sortData(t){let e=t.direction,n=t.active;(!n||e==="")&&(n="",e=""),this.searchForm.patchValue({sortBy:n,sortOrder:e}),this.getLogList()}filterParams(){let t=new dt;return t=t.append("skip",this.pagination.pageIndex*this.pagination.pageSize),t=t.append("limit",this.pagination.pageSize),this.searchForm.value.searchString&&(t=t.append("searchString",this.searchForm.value.searchString)),this.searchForm.value.action&&(t=t.append("action",this.searchForm.value.action)),this.searchForm.value.type&&(t=t.append("type",this.searchForm.value.type)),this.searchForm.value.operation&&(t=t.append("operation",this.searchForm.value.operation)),this.searchForm.value.sortBy&&(t=t.append("sortBy",this.searchForm.value.sortBy)),this.searchForm.value.sortOrder&&(t=t.append("sortOrder",this.searchForm.value.sortOrder)),this.updateRoute(),t}getLogList(){return S(this,null,function*(){try{let t=yield this._logService.getLogList(this.filterParams());this.dataSource.data=t.items,this.paginator.pageIndex=this.pagination.pageIndex,this.paginator.length=t.count}catch(t){this._utilService.showErrorSnack(t)}})}pageChanged(t){this.pagination.pageSize=t.pageSize,this.pagination.pageIndex=t.pageIndex,this.getLogList()}replaceString(t){return t=t.replaceAll(/\n/g,"<br class='hide'/>"),t}goToDetails(t){this._router.navigate(["/log-report/details",t.id],{relativeTo:this._activatedRoute,queryParams:{q:this._utilService.encode(this.urlParams)}})}static \u0275fac=function(e){return new(e||i)(c(Lt),c(L),c(T),c(I),c(P))};static \u0275cmp=b({type:i,selectors:[["app-log-list"]],viewQuery:function(e,n){if(e&1&&($(O,5),$(R,5)),e&2){let m;G(m=q())&&(n.sort=m.first),G(m=q())&&(n.paginator=m.first)}},decls:51,vars:7,consts:[[1,"w-full","p-8"],[1,"md:flex","justify-between","w-full","items-center","mb-8"],[1,"text-primary","text-xl","font-extrabold","md:m-0"],["action","",3,"formGroup"],[1,"grid","md:grid-cols-4","grid-cols-1","gap-4","my-2"],[1,"w-full","fuse-mat-dense"],["placeholder","User Name","formControlName","searchString"],["placeholder","Select Type","formControlName","type",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Action","formControlName","action",3,"selectionChange"],["placeholder","Select Operation","formControlName","operation",3,"selectionChange"],[1,"w-full","overflow-x-auto","bg-white","border","rounded-lg"],["mat-table","","matSort","",1,"w-full",3,"matSortChange","dataSource"],["matColumnDef","no"],["mat-header-cell","","width","70","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","action"],["matColumnDef","operation"],["matColumnDef","description"],["mat-cell","","class","detail-td",4,"matCellDef"],["matColumnDef","createdAt"],["mat-header-row","",4,"matHeaderRowDef"],["class","mat-row",4,"matNoDataRow"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"flex","justify-end","mt-2"],[1,"bg-transparent"],[3,"value"],["mat-header-cell","","width","70",1,"text-center"],["mat-cell","",1,"text-center"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"detail-td"],[1,"details-text",3,"innerHTML"],[1,"hide"],["mat-header-row",""],[1,"mat-row"],[1,"text-center","p-3"],["mat-row","",3,"click"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Log Report "),o()(),a(4,"form",3)(5,"div",4)(6,"mat-form-field",5),u(7,"mat-select",6),o(),a(8,"mat-form-field",5)(9,"mat-select",7),v("selectionChange",function(){return n.resetPagination(),n.getLogList()}),a(10,"mat-option"),r(11,"All"),o(),d(12,Qt,2,2,"mat-option",8),o()(),a(13,"mat-form-field",5)(14,"mat-select",9),v("selectionChange",function(){return n.resetPagination(),n.getLogList()}),a(15,"mat-option"),r(16,"All"),o(),d(17,Zt,2,2,"mat-option",8),o()(),a(18,"mat-form-field",5)(19,"mat-select",10),v("selectionChange",function(){return n.resetPagination(),n.getLogList()}),a(20,"mat-option"),r(21,"All"),o(),d(22,Jt,2,2,"mat-option",8),o()()()(),a(23,"div",11)(24,"table",12),v("matSortChange",function(g){return n.sortData(g)}),f(25,13),d(26,Kt,2,0,"th",14)(27,Wt,2,1,"td",15),h(),f(28,16),d(29,Xt,2,0,"th",17)(30,Yt,4,3,"td",18),h(),f(31,19),d(32,te,2,0,"th",17)(33,ee,2,1,"td",18),h(),f(34,20),d(35,ie,2,0,"th",17)(36,ne,2,1,"td",18),h(),f(37,21),d(38,oe,2,0,"th",17)(39,ae,2,1,"td",18),h(),f(40,22),d(41,re,2,0,"th",17)(42,le,2,1,"td",23),h(),f(43,24),d(44,me,2,0,"th",17)(45,se,6,8,"td",18),h(),d(46,pe,1,0,"tr",25)(47,de,3,1,"tr",26)(48,ce,1,0,"tr",27),o()(),a(49,"div",28),u(50,"mat-paginator",29),o()()),e&2&&(l(4),p("formGroup",n.searchForm),l(8),p("ngForOf",n.constantValues==null?null:n.constantValues.logTypes),l(5),p("ngForOf",n.constantValues==null?null:n.constantValues.logActions),l(5),p("ngForOf",n.constantValues==null?null:n.constantValues.logOperations),l(2),p("dataSource",n.dataSource),l(22),p("matHeaderRowDef",n.displayedColumns),l(2),p("matRowDefColumns",n.displayedColumns))},dependencies:[mt,gt,wt,R,Et,O,Dt,Mt,Pt,Ot,Ft,It,At,Tt,Rt,Ht,Bt,Vt,_t,ht,vt,St,Ct,M],styles:[".detail-td[_ngcontent-%COMP%]{max-width:350px!important}.details-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}@media (max-width: 768px){.detail-td[_ngcontent-%COMP%]{max-width:330px!important}.mainTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{display:block}}"]})};var ue=[{path:"",component:H,canActivate:[Z("LOG_READ_ALL")]},{path:"details/:id",component:A,canActivate:[Z("LOG_READ_ALL")]}],zt=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=et({type:i});static \u0275inj=tt({imports:[pt,kt,yt,xt,ut.forChild(ue)]})};export{zt as LogReportModule};
