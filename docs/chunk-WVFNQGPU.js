import{a as Xe}from"./chunk-ZGJGSVCR.js";import{a as Ke}from"./chunk-B3HKNKN2.js";import{a as dt,b as et}from"./chunk-DO37JCVR.js";import{a as z}from"./chunk-3WZ5H7VG.js";import{a as N}from"./chunk-2JKRYZF2.js";import{b as Ie}from"./chunk-XGORUSYF.js";import{a as j,b as k,e as L}from"./chunk-ZMQNNO6W.js";import{A as Te,B as te,C as ke,D as B,E as ie,K as De,S as re,T as Pe,U as ne,W as Me,X as Ve,aa as Le,ba as oe,ca as Ne,da as Be,ea as Oe,fa as je,g as q,ga as ze,h as V,ha as $e,i as G,ia as He,ja as qe,k as Q,ka as Ge,l as b,la as Qe,m as W,ma as We,n as Z,na as Ze,o as h,oa as Ye,p as Y,qa as Je,r as J,s as K,t as X,v as Fe,w as Re,x as ee}from"./chunk-JBASF3LD.js";import"./chunk-RGNDWIHZ.js";import{b as Ae,d as xe,j as P,l as M,p as Ee}from"./chunk-TN7LRJOG.js";import{l as ye,m as H,t as be}from"./chunk-MKB6ZC6F.js";import{$b as ce,Aa as u,Ab as l,Ba as f,Gb as E,Hb as I,Ib as F,Jb as n,Kb as o,Lb as U,Mb as R,N as he,Nb as T,Pb as v,S as ve,Vb as p,Xb as g,ac as de,ba as le,bc as pe,eb as m,ec as O,f as ct,fb as d,fc as a,g as C,gc as y,ha as ge,hc as S,ia as Se,m as _e,ma as Ce,ra as D,sa as Ue,vb as _,x,zb as we}from"./chunk-L2AW7WK7.js";var A=class i{constructor(e){this.http=e}getAdminUserList(e){return x(this.http.get(k.ADMIN_USER_LIST,{params:e}))}createAdminUser(e){return x(this.http.post(k.ADMIN_USER,e))}updateAdminUser(e){return x(this.http.patch(`${k.ADMIN_USER}`,e))}deleteAdminUser(e){return x(this.http.delete(`${k.ADMIN_USER}/${e}`))}getAdminUserById(e){return x(this.http.get(`${k.ADMIN_USER_FIND_BY_ID}/${e}`))}getRoleList(){return x(this.http.get(`${k.ADMIN_USER_ROLE_LIST}`))}static \u0275fac=function(t){return new(t||i)(Ce(xe))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})};function ht(i,e){i&1&&(n(0,"th",32),a(1,"No."),o())}function vt(i,e){if(i&1&&(n(0,"td",33),a(1),o()),i&2){let t=e.index,r=g();m(),S(" ",r.pagination.pageIndex*r.pagination.pageSize+(t+1)," ")}}function gt(i,e){i&1&&(n(0,"th",34),a(1,"Name"),o())}function St(i,e){if(i&1&&(n(0,"td",35),a(1),o()),i&2){let t=e.$implicit;m(),S(" ",t.name," ")}}function Ct(i,e){i&1&&(n(0,"th",34),a(1,"Email"),o())}function Ut(i,e){if(i&1&&(n(0,"td",35),a(1),o()),i&2){let t=e.$implicit;m(),S(" ",t.email," ")}}function wt(i,e){i&1&&(n(0,"th",34),a(1,"Role"),o())}function yt(i,e){if(i&1&&(n(0,"td",35),a(1),o()),i&2){let t=e.$implicit;m(),S(" ",t.role," ")}}function bt(i,e){i&1&&(n(0,"th",34),a(1,"Status"),o())}function At(i,e){if(i&1&&(n(0,"td",35),a(1),o()),i&2){let t=e.$implicit;m(),S(" ",t.active?"Active":"Inactive"," ")}}function xt(i,e){i&1&&(n(0,"th",36),a(1,"Action"),o())}function Et(i,e){if(i&1){let t=v();n(0,"td",37),p("click",function(s){return u(t),f(s.stopPropagation())}),n(1,"button",38),p("click",function(){let s=u(t).$implicit,c=g();return f(c.goTo("/admin-user/form/"+s.id))}),n(2,"mat-icon"),a(3,"edit"),o()()()}}function It(i,e){i&1&&U(0,"tr",39)}function Ft(i,e){if(i&1&&(n(0,"tr",40)(1,"td",41),a(2," No data found "),o()()),i&2){let t=g();m(),we("colspan",t.displayedColumns.length)}}function Rt(i,e){if(i&1){let t=v();n(0,"tr",42),p("click",function(){let s=u(t).$implicit,c=g();return f(c.goTo(c._userService.hasAccess(c.accessControls.USER_READ_DETAILS)?"/admin-user/view/"+s.id:null))}),o()}}var se=class i{constructor(e,t,r,s,c,w){this._fb=e;this._appUserService=t;this._userService=r;this._activatedRoute=s;this._router=c;this._utilService=w}sort;paginator;accessControls=j;displayedColumns=["no","name","email","role","active","action"];dataSource=new Ye;pagination={pageSizeOptions:[10,25,50,100],pageSize:10,pageIndex:0};searchForm;onDestroy=new _e;urlParams=null;ngOnInit(){this.searchForm=this._fb.group({searchString:new h(null),role:new h(null),status:new h(null),sortBy:new h(""),sortOrder:new h("")}),this._activatedRoute.queryParams.pipe(le(this.onDestroy)).subscribe(e=>{try{let t=this._utilService.decode(e.q);this.urlParams=t;let r={};t?.page&&!this.pagination.pageIndex&&(this.pagination.pageIndex=parseInt(t?.page)),t?.size&&(this.pagination.pageSize=t?.size),t?.searchString&&!this.searchForm.value.searchString&&(r.searchString=t?.searchString),t?.role&&!this.searchForm.value.role&&(r.role=t?.role),t?.status&&!this.searchForm.value.status&&(r.status=t?.status),t?.sortBy&&!this.searchForm.value.sortBy&&(r.sortBy=t?.sortBy),t?.sortOrder&&!this.searchForm.value.sortOrder&&(r.sortOrder=t?.sortOrder),this.searchForm.patchValue(r)}catch(t){this._utilService.showErrorSnack(t)}}),this.searchForm.get("searchString")?.valueChanges.pipe(le(this.onDestroy),he(500),ve()).subscribe(e=>{this.resetPagination(),this.getAdminUserList()}),this.getAdminUserList()}resetPagination(){this.pagination.pageIndex=0}updateRoute(){let e={page:this.pagination.pageIndex,size:this.pagination.pageSize,searchString:this.searchForm.value.searchString??"",role:this.searchForm.value.role??"",status:this.searchForm.value.status??"",sortBy:this.searchForm.value.sortBy??"",sortOrder:this.searchForm.value.sortOrder??""};this._router.navigate([],{replaceUrl:!0,relativeTo:this._activatedRoute,queryParams:{q:this._utilService.encode(e)},queryParamsHandling:"merge"})}ngAfterViewInit(){this.urlParams?.sortBy&&this.urlParams?.sortOrder&&this.sort.sort({id:this.urlParams.sortBy,start:this.urlParams.sortOrder.toLowerCase()}),this.dataSource.sort=this.sort,this.paginator._intl.itemsPerPageLabel="Records Per Page"}ngOnDestroy(){this.onDestroy.next(),this.onDestroy.complete()}sortData(e){let t=e.direction,r=e.active;(!r||t==="")&&(r="",t=""),this.searchForm.patchValue({sortBy:r,sortOrder:t}),this.getAdminUserList()}filterParams(){let e=new Ae;return e=e.append("skip",this.pagination.pageIndex*this.pagination.pageSize),e=e.append("limit",this.pagination.pageSize),this.searchForm.value.searchString&&(e=e.append("searchString",this.searchForm.value.searchString)),this.searchForm.value.role&&(e=e.append("role",this.searchForm.value.role)),this.searchForm.value.status&&(e=e.append("status",this.searchForm.value.status)),this.searchForm.value.sortBy&&(e=e.append("sortBy",this.searchForm.value.sortBy)),this.searchForm.value.sortOrder&&(e=e.append("sortOrder",this.searchForm.value.sortOrder)),this.updateRoute(),e}getAdminUserList(){return C(this,null,function*(){try{let e=yield this._appUserService.getAdminUserList(this.filterParams());this.dataSource.data=e.items,this.paginator.pageIndex=this.pagination.pageIndex,this.paginator.length=e.count}catch(e){this._utilService.showErrorSnack(e)}})}pageChanged(e){this.pagination.pageSize=e.pageSize,this.pagination.pageIndex=e.pageIndex,this.getAdminUserList()}goTo(e){e&&this._router.navigate([e],{relativeTo:this._activatedRoute,queryParams:{q:this._utilService.encode(this.urlParams)}})}static \u0275fac=function(t){return new(t||i)(d(X),d(A),d(N),d(P),d(M),d(L))};static \u0275cmp=D({type:i,selectors:[["app-admin-user-list"]],viewQuery:function(t,r){if(t&1&&(ce(oe,5),ce(ne,5)),t&2){let s;de(s=pe())&&(r.sort=s.first),de(s=pe())&&(r.paginator=s.first)}},decls:57,vars:12,consts:[["paginator",""],[1,"w-full","p-8"],[1,"md:flex","justify-between","w-full","items-center","mb-8"],[1,"text-primary","text-xl","font-extrabold","md:m-0"],["mat-raised-button","","color","primary",1,"rounded",3,"click"],[1,"mr-1"],["action","",3,"formGroup"],[1,"grid","md:grid-cols-4","grid-cols-1","gap-4","my-2"],[1,"w-full","fuse-mat-dense"],["matInput","","placeholder","Search","formControlName","searchString"],["matInput","","placeholder","User Role","formControlName","role",3,"selectionChange"],[3,"value"],["matInput","","placeholder","Status","formControlName","status",3,"selectionChange"],[1,"w-full","overflow-x-auto","bg-white","border","rounded-lg"],["mat-table","","matSort","",1,"w-full",3,"matSortChange","dataSource"],["matColumnDef","no"],["mat-header-cell","","width","80",4,"matHeaderCellDef"],["mat-cell","","width","80",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","active"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"click",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","mat-row",4,"matNoDataRow"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"flex","justify-end","mt-2"],[1,"bg-transparent",3,"page","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell","","width","80"],["mat-cell","","width","80"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-cell","",3,"click"],["mat-icon-button","",3,"click"],["mat-header-row",""],[1,"mat-row"],[1,"text-center","p-3"],["mat-row","",3,"click"]],template:function(t,r){if(t&1){let s=v();n(0,"div",1)(1,"div",2)(2,"h2",3),a(3,"App Users List"),o(),n(4,"div")(5,"button",4),p("click",function(){return u(s),f(r.goTo("/admin-user/form"))}),n(6,"mat-icon",5),a(7,"add"),o(),a(8," Add User "),o()()(),n(9,"form",6)(10,"div",7)(11,"mat-form-field",8),U(12,"input",9),o(),n(13,"mat-form-field",8)(14,"mat-select",10),p("selectionChange",function(){return u(s),r.resetPagination(),f(r.getAdminUserList())}),n(15,"mat-option"),a(16,"All"),o(),n(17,"mat-option",11),a(18,"Super Admin"),o(),n(19,"mat-option",11),a(20,"Admin"),o(),n(21,"mat-option",11),a(22,"Operator"),o()()(),n(23,"mat-form-field",8)(24,"mat-select",12),p("selectionChange",function(){return u(s),r.resetPagination(),f(r.getAdminUserList())}),n(25,"mat-option"),a(26,"All"),o(),n(27,"mat-option",11),a(28,"Active"),o(),n(29,"mat-option",11),a(30,"Inactive"),o()()()()(),n(31,"div",13)(32,"table",14),p("matSortChange",function(w){return u(s),f(r.sortData(w))}),R(33,15),_(34,ht,2,0,"th",16)(35,vt,2,1,"td",17),T(),R(36,18),_(37,gt,2,0,"th",19)(38,St,2,1,"td",20),T(),R(39,21),_(40,Ct,2,0,"th",19)(41,Ut,2,1,"td",20),T(),R(42,22),_(43,wt,2,0,"th",19)(44,yt,2,1,"td",20),T(),R(45,23),_(46,bt,2,0,"th",19)(47,At,2,1,"td",20),T(),R(48,24),_(49,xt,2,0,"th",25)(50,Et,4,0,"td",26),T(),_(51,It,1,0,"tr",27)(52,Ft,3,1,"tr",28)(53,Rt,1,0,"tr",29),o()(),n(54,"div",30)(55,"mat-paginator",31,0),p("page",function(w){return u(s),f(r.pageChanged(w))}),o()()()}t&2&&(m(9),l("formGroup",r.searchForm),m(8),l("value","SuperAdmin"),m(2),l("value","Admin"),m(2),l("value","Operator"),m(6),l("value","Active"),m(2),l("value","Inactive"),m(3),l("dataSource",r.dataSource),m(19),l("matHeaderRowDef",r.displayedColumns),m(2),l("matRowDefColumns",r.displayedColumns),m(2),l("pageSize",r.pagination.pageSize)("pageIndex",r.pagination.pageIndex)("pageSizeOptions",r.pagination.pageSizeOptions))},dependencies:[q,V,G,B,ie,te,ne,re,oe,Ne,Be,je,qe,ze,Oe,Ge,$e,He,Qe,We,Ze,Y,Q,W,Z,J,K]})};var fe=ct(dt());function kt(i,e){if(i&1&&(n(0,"mat-option",16),a(1),o()),i&2){let t=e.$implicit;l("value",t.id),m(),y(t.name)}}function Dt(i,e){i&1&&(n(0,"mat-icon",31),a(1,"visibility_off"),o())}function Pt(i,e){i&1&&(n(0,"mat-icon",31),a(1,"visibility"),o())}function Mt(i,e){if(i&1){let t=v();n(0,"mat-form-field",11)(1,"mat-label"),a(2,"Enter Password "),n(3,"mat-icon",27),a(4," info "),o()(),U(5,"input",28,0),n(7,"button",29),p("click",function(){u(t);let s=O(6);return f(s.type==="password"?s.type="text":s.type="password")}),_(8,Dt,2,0,"mat-icon",30)(9,Pt,2,0,"mat-icon",30),o()()}if(i&2){let t=O(6);m(8),l("ngIf",t.type==="text"),m(),l("ngIf",t.type==="password")}}function Vt(i,e){i&1&&(n(0,"mat-icon",31),a(1,"visibility_off"),o())}function Lt(i,e){i&1&&(n(0,"mat-icon",31),a(1,"visibility"),o())}function Nt(i,e){if(i&1){let t=v();n(0,"mat-form-field",11)(1,"mat-label"),a(2,"Re-enter Password"),n(3,"mat-icon",27),a(4," info "),o()(),U(5,"input",32,1),n(7,"button",29),p("click",function(){u(t);let s=O(6);return f(s.type==="password"?s.type="text":s.type="password")}),_(8,Vt,2,0,"mat-icon",30)(9,Lt,2,0,"mat-icon",30),o()()}if(i&2){let t=O(6);m(8),l("ngIf",t.type==="text"),m(),l("ngIf",t.type==="password")}}function Bt(i,e){i&1&&(n(0,"div")(1,"mat-label",33),a(2,"Status"),o(),n(3,"div",34)(4,"span"),a(5,"Inactive"),o(),U(6,"mat-slide-toggle",35),n(7,"span"),a(8,"Active"),o()()())}function Ot(i,e){if(i&1&&(n(0,"mat-radio-button",21),a(1),o()),i&2){let t=e.$implicit;l("value",t),m(),y(t)}}function jt(i,e){if(i&1){let t=v();n(0,"mat-checkbox",38),p("change",function(s){let c=u(t).$implicit,w=g(2);return f(w.onChangePermissionCheckBox(s,c.value))}),a(1),o()}if(i&2){let t=e.$implicit,r=g(2);l("checked",r.userForm.value==null||r.userForm.value.accessControls==null?null:r.userForm.value.accessControls.includes(t.value)),m(),y(t.label)}}function zt(i,e){if(i&1&&(n(0,"div",23)(1,"h6",36),a(2),o(),I(3,jt,2,2,"mat-checkbox",37,E),o()),i&2){let t=e.$implicit;m(2),S(" ",t.category,""),m(),F(t.accessControls)}}var $=class i{constructor(e,t,r,s,c,w,lt){this._activatedRoute=e;this._fb=t;this._router=r;this._utilService=s;this._userService=c;this._shopService=w;this._adminUserService=lt}userForm;currentUserId=null;currentUser=null;roles=[];submitEnable=!0;urlParams=null;shopDropdown=null;accessControls=[];accessControlsRoleWise=[];ngOnInit(){this._activatedRoute.paramMap.subscribe(e=>{this.currentUserId=e.get("id"),this.initializeForm(),this.loadPreData()}),this._activatedRoute.queryParams.subscribe(e=>{this.urlParams=e})}initializeForm(){this.userForm=this._fb.group({name:new h(null,[b.required]),email:new h(null,[b.required,b.email]),role:new h(null,[b.required]),shopAccess:new h(null,[b.required]),accessControls:new h([]),active:new h(!0)}),this.currentUserId||(this.userForm.addControl("password",new h(null,[b.pattern("^(?=.*[A-Z])(?=.*\\d)(?=.*[@*#])[A-Za-z\\d@*#]{8,}$")])),this.userForm.addControl("confirmPassword",new h(null,[b.pattern("^(?=.*[A-Z])(?=.*\\d)(?=.*[@*#])[A-Za-z\\d@*#]{8,}$")])))}get f(){return this.userForm.controls}loadPreData(){return C(this,null,function*(){try{this.roles=yield this._adminUserService.getRoleList(),this.shopDropdown=yield this._shopService.getShopDropdown();let e=yield this._userService.getAccessControlsList();if(this.accessControls=e.modules,this.accessControlsRoleWise=yield this._userService.getAccessControlsRoleWiseList(),this.currentUserId)this.currentUser=yield this._adminUserService.getAdminUserById(this.currentUserId),this.userForm.patchValue({name:this.currentUser?.name,email:this.currentUser?.email,active:this.currentUser?.active,role:this.currentUser?.role,shopAccess:this.currentUser?.shopAccess??[],accessControls:this.currentUser?.accessControls??[]});else{let t=this.roles[0];this.userForm.patchValue({role:t}),this.onChangeRole(t)}}catch(e){this._utilService.showErrorSnack(e)}})}onChangeRole(e){let t=[];this.accessControlsRoleWise.map(r=>{r.role==e&&(e=="SuperAdmin"?this.accessControls.map(s=>{s.accessControls.map(c=>{t.push(c.value)})}):r.accessControls.map(s=>{s.accessControls.map(c=>{t.push(c.value)})}))}),this.userForm.patchValue({accessControls:t})}onChangePermissionCheckBox(e,t){var r=(0,fe.cloneDeep)(this.userForm.value.accessControls)??[];e.checked?r.push(t):r=r.filter(s=>s!=t),this.userForm.patchValue({accessControls:r})}onSubmit(){return C(this,null,function*(){if(this.userForm.invalid){this.userForm.markAllAsTouched();return}if(this.currentUserId==null&&this.userForm.value.password!=this.userForm.value.confirmPassword){this._utilService.showErrorSnack("Confirm password does not match!");return}var e=(0,fe.cloneDeep)(this.userForm.value);delete e.confirmPassword,this.currentUserId&&!e.password&&delete e.password;try{this.submitEnable=!1;let t;this.currentUserId?(e.id=this.currentUserId,t=yield this._adminUserService.updateAdminUser(e)):t=yield this._adminUserService.createAdminUser(e),this._utilService.showSuccessSnack(t.message),this.backToList()}catch(t){this._utilService.showErrorSnack(t)}finally{this.submitEnable=!0}})}backToList(){this._router.navigate(["/admin-user"],{queryParams:this.urlParams})}static \u0275fac=function(t){return new(t||i)(d(P),d(X),d(M),d(L),d(N),d(Ke),d(A))};static \u0275cmp=D({type:i,selectors:[["app-create-admin-user"]],decls:48,vars:6,consts:[["passwordField",""],["cPasswordField",""],[1,"w-full","p-8"],[1,"flex","justify-between","w-full","items-center","mb-8"],[1,"text-primary","text-xl","font-bold","m-0"],["mat-button","",1,"rounded",3,"click"],[1,"mr-1"],[3,"ngSubmit","formGroup"],[1,"bg-white","border","rounded-md","mt-8"],[1,"text-base","font-semibold","py-3","border-b","px-6","m-0"],[1,"grid","md:grid-cols-3","grid-cols-1","gap-x-5","gap-y-2","p-6"],["floatLabel","always"],["matInput","","placeholder","Enter Name","formControlName","name"],["matInput","","placeholder","Enter Email, eg. jacob@gmail.com","formControlName","email"],[1,"w-full"],["multiple","",3,"formControlName"],[3,"value"],["floatLabel","always",4,"ngIf"],[4,"ngIf"],[1,"grid","md:grid-cols-2","grid-cols-1","gap-x-5","gap-y-2","p-6"],["formControlName","role",3,"change"],[1,"mr-4",3,"value"],[1,"grid","md:grid-cols-3","grid-cols-1","gap-8","p-6"],[1,"border","rounded-md","p-4"],[1,"flex","justify-end","mt-8"],["mat-raised-button","","type","button",1,"rounded","mr-5","bg-[#EFEFEF]","text-[#111725]",3,"click"],["mat-raised-button","","color","primary",1,"rounded"],["matTooltip","Minimum 8 character with one uppercase, include special characters like @ * #",1,"float-right"],["type","password","matInput","","placeholder","Enter Enter Password","formControlName","password"],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",4,"ngIf"],[1,"icon-size-5"],["type","password","matInput","","placeholder","Enter Re-enter Password","formControlName","confirmPassword"],[1,"text-sm","text-primary"],[1,"flex","mt-2","text-sm","items-center"],["formControlName","active",1,"mx-3"],[1,"text-base","font-semibold","mb-2"],[1,"w-full",3,"checked"],[1,"w-full",3,"change","checked"]],template:function(t,r){t&1&&(n(0,"div",2)(1,"div",3)(2,"h2",4),a(3),o(),n(4,"button",5),p("click",function(){return r.backToList()}),n(5,"mat-icon",6),a(6,"arrow_back"),o(),a(7," Back to Users "),o()(),n(8,"form",7),p("ngSubmit",function(){return r.onSubmit()}),n(9,"div",8)(10,"h6",9),a(11,"User Details"),o(),n(12,"div",10)(13,"mat-form-field",11)(14,"mat-label"),a(15,"Name"),o(),U(16,"input",12),o(),n(17,"mat-form-field",11)(18,"mat-label"),a(19,"Email"),o(),U(20,"input",13),o(),n(21,"mat-form-field",14)(22,"mat-label"),a(23,"Shop"),o(),n(24,"mat-select",15),I(25,kt,2,2,"mat-option",16,E),o()(),_(27,Mt,10,2,"mat-form-field",17)(28,Nt,10,2,"mat-form-field",17)(29,Bt,9,0,"div",18),o()(),n(30,"div",8)(31,"h6",9),a(32,"User Role"),o(),n(33,"div",19)(34,"mat-radio-group",20),p("change",function(c){return r.onChangeRole(c.value)}),I(35,Ot,2,2,"mat-radio-button",21,E),o()()(),n(37,"div",8)(38,"h6",9),a(39,"Permissions"),o(),n(40,"div",22),I(41,zt,5,1,"div",23,E),o()(),n(43,"div",24)(44,"button",25),p("click",function(){return r.backToList()}),a(45,"Cancel"),o(),n(46,"button",26),a(47,"Save"),o()()()()),t&2&&(m(3),S("",r.currentUserId?"Update":"Create New"," User"),m(5),l("formGroup",r.userForm),m(16),l("formControlName","shopAccess"),m(),F(r.shopDropdown),m(2),l("ngIf",!r.currentUserId),m(),l("ngIf",!r.currentUserId),m(),l("ngIf",r.currentUserId),m(6),F(r.roles),m(6),F(r.accessControls))},dependencies:[H,q,V,G,ke,B,ie,te,ee,Te,Me,Ve,re,Le,Pe,Y,Q,W,Z,J,K]})};function $t(i,e){if(i&1){let t=v();n(0,"button",19),p("click",function(){u(t);let s=g();return f(s.goTo("/admin-user/form/"+s.adminUserId))}),a(1," Edit "),n(2,"mat-icon",4),a(3,"edit"),o()()}}function Ht(i,e){if(i&1){let t=v();n(0,"button",20),p("click",function(){u(t);let s=g();return f(s.resetPassword())}),a(1,"Reset Password "),o()}}function qt(i,e){if(i&1){let t=v();n(0,"button",21),p("click",function(){u(t);let s=g();return f(s.deleteUser())}),a(1," Delete "),n(2,"mat-icon",4),a(3,"delete"),o()()}}function Gt(i,e){i&1&&(n(0,"p",22),a(1," Active "),o())}function Qt(i,e){i&1&&(n(0,"p",23),a(1," Inactive "),o())}function Wt(i,e){if(i&1&&(n(0,"p",25),a(1),o()),i&2){let t=e.$implicit;m(),y(t.label)}}function Zt(i,e){if(i&1&&(n(0,"div")(1,"mat-label",24),a(2),o(),I(3,Wt,2,1,"p",25,E),o()),i&2){let t=e.$implicit;m(2),y(t.category),m(),F(t.accessControls)}}var me=class i{constructor(e,t,r,s,c,w,lt){this._activatedRoute=e;this._router=t;this._adminUserService=r;this._userService=s;this._authService=c;this._utilService=w;this._dialog=lt}accessControlsList=j;accessControls=[];adminUser=null;adminUserId;urlParams=null;ngOnInit(){this._activatedRoute.paramMap.subscribe(e=>{this.adminUserId=e.get("id")??"",this.loadPreData()}),this._activatedRoute.queryParams.subscribe(e=>{this.urlParams=e})}loadPreData(){return C(this,null,function*(){try{this.adminUser=yield this._adminUserService.getAdminUserById(this.adminUserId);let e=yield this._userService.getAccessControlsList(),t=[];e.modules.map(r=>{let s={category:r.category,accessControls:[]};r.accessControls.map(c=>{this.adminUser?.accessControls.includes(c.value)&&s.accessControls.push(c)}),s.accessControls.length&&t.push(s)}),this.accessControls=t}catch(e){this._utilService.showErrorSnack(e)}})}goTo(e){e&&this._router.navigate([e],{relativeTo:this._activatedRoute,queryParams:this.urlParams})}resetPassword(){this._dialog.open(Xe,{data:{title:"Are sure you want to Reset password?"}}).afterClosed().subscribe(t=>C(this,null,function*(){if(t)try{this._utilService.showErrorSnack("This feature is not implemented yet.")}catch(r){this._utilService.showErrorSnack(r)}}))}deleteUser(){this._dialog.open(et,{data:{title:"Are sure you want to delete this user?"}}).afterClosed().subscribe(t=>C(this,null,function*(){if(t)try{yield this._adminUserService.deleteAdminUser(this.adminUserId),this._utilService.showSuccessSnack("User deleted successfully"),this.goTo("/admin-user")}catch(r){this._utilService.showErrorSnack(r)}}))}static \u0275fac=function(t){return new(t||i)(d(P),d(M),d(A),d(N),d(Ie),d(L),d(De))};static \u0275cmp=D({type:i,selectors:[["app-view-admin-user"]],decls:43,vars:9,consts:[[1,"w-full","p-8"],[1,"md:flex","justify-between","w-full","items-center","mb-8"],[1,"text-primary","text-xl","font-bold","md:m-0"],["mat-button","",1,"rounded",3,"click"],[1,"mr-1"],[1,"bg-white","border","rounded-md"],[1,"md:flex","justify-between","w-full","items-center","border-b"],[1,"text-base","font-semibold","py-3","px-6","m-0"],["mat-raised-button","","color","primary","class","rounded mr-5 m-2",3,"click",4,"ngIf"],["mat-stroked-button","","color","primary","class","rounded mr-5 m-2",3,"click",4,"ngIf"],["mat-stroked-button","","color","warn","class","rounded mr-5",3,"click",4,"ngIf"],[1,"grid","md:grid-cols-4","grid-cols-1","gap-5","p-6","text-sm","font-light"],[1,"text-secondary"],[1,"mt-2","mb-0","font-medium"],["class","mt-2 mb-0 font-medium bg-[#CCEEC1] border border-[#54C632] rounded-full w-fit px-4 py-1",4,"ngIf"],["class","mt-2 mb-0 font-medium bg-[#ff7f7f] border border-[#FF0000] rounded-full w-fit px-4 py-1",4,"ngIf"],[1,"bg-white","border","rounded-md","mt-8"],[1,"grid","md:grid-cols-3","grid-cols-1","gap-x-5","gap-y-10","p-6","text-sm","font-light"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"rounded","mr-5","m-2",3,"click"],["mat-stroked-button","","color","primary",1,"rounded","mr-5","m-2",3,"click"],["mat-stroked-button","","color","warn",1,"rounded","mr-5",3,"click"],[1,"mt-2","mb-0","font-medium","bg-[#CCEEC1]","border","border-[#54C632]","rounded-full","w-fit","px-4","py-1"],[1,"mt-2","mb-0","font-medium","bg-[#ff7f7f]","border","border-[#FF0000]","rounded-full","w-fit","px-4","py-1"],[1,"font-semibold"],[1,"mt-2","mb-0","text-sm"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"View Admin User"),o(),n(4,"button",3),p("click",function(){return r.goTo("/admin-user")}),n(5,"mat-icon",4),a(6,"arrow_back"),o(),a(7," Back to Users "),o()(),n(8,"div",5)(9,"div",6)(10,"h6",7),a(11,"User Details"),o(),n(12,"div"),_(13,$t,4,0,"button",8)(14,Ht,2,0,"button",9)(15,qt,4,0,"button",10),o()(),n(16,"div",11)(17,"div")(18,"mat-label",12),a(19,"Name"),o(),n(20,"p",13),a(21),o()(),n(22,"div")(23,"mat-label",12),a(24,"Email"),o(),n(25,"p",13),a(26),o()(),n(27,"div")(28,"mat-label",12),a(29,"Status"),o(),_(30,Gt,2,0,"p",14)(31,Qt,2,0,"p",15),o(),n(32,"div")(33,"mat-label",12),a(34,"User Role"),o(),n(35,"p",13),a(36),o()()()(),n(37,"div",16)(38,"div",6)(39,"h6",7),a(40,"Permissions"),o()(),n(41,"div",17),_(42,Zt,5,1,"div",18),o()()()),t&2&&(m(13),l("ngIf",r._userService.hasAccess(r.accessControlsList.USER_UPDATE)),m(),l("ngIf",r._userService.hasAccess(r.accessControlsList.USER_UPDATE)),m(),l("ngIf",r._userService.hasAccess(r.accessControlsList.USER_DELETE)),m(6),S(" ",r.adminUser==null?null:r.adminUser.name," "),m(5),S(" ",r.adminUser==null?null:r.adminUser.email," "),m(4),l("ngIf",r.adminUser==null?null:r.adminUser.active),m(),l("ngIf",!(r.adminUser!=null&&r.adminUser.active)),m(5),y(r.adminUser==null?null:r.adminUser.role),m(6),l("ngForOf",r.accessControls))},dependencies:[ye,H,V,B,ee]})};var Yt=[{path:"",component:se,canActivate:[z("USER_READ_LIST")]},{path:"form",component:$,canActivate:[z("USER_CREATE")]},{path:"form/:id",component:$,canActivate:[z("USER_UPDATE")]},{path:"view/:id",component:me,canActivate:[z("USER_READ_DETAILS")]}],mt=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=Ue({type:i});static \u0275inj=Se({imports:[be,Je,Fe,Re,Ee.forChild(Yt)]})};export{mt as AdminUserModule};
